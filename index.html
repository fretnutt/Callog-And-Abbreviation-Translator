<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Call Logger & Abbreviation Translator</title>
    <style>
        body { font-family: sans-serif; padding: 20px; background-color: #f4f4f4; color: #333; }
        .container { display: flex; gap: 20px; width: 100%; margin-bottom: 20px; }
        .box { flex: 1; background-color: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); }
        textarea { width: 100%; height: 150px; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 16px; resize: vertical; }
        h1, h2 { color: #0056b3; margin-top: 0; }
        #abbreviationsContainer { margin-top: 20px; padding-top: 20px; border-top: 1px solid #ddd; }

        .abbreviations-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        #toggleAllBtn {
            padding: 8px 12px;
            border: 1px solid #0056b3;
            background-color: #007bff;
            color: white;
            border-radius: 5px;
            cursor: pointer;
        }
        #toggleAllBtn:hover {
            background-color: #0056b3;
        }
        
        .section {
            background-color: #fff;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .section-title {
            font-weight: bold;
            color: #0056b3;
            font-size: 1.2em;
            margin: 0;
            cursor: pointer;
            position: relative;
            padding-right: 20px;
        }

        .section-title::after {
            content: 'â–¶';
            position: absolute;
            right: 5px;
            font-size: 0.8em;
            transition: transform 0.2s;
        }

        .section-title.active::after {
            transform: rotate(90deg);
        }
        
        .section-content {
            display: none; /* Content is hidden by default */
            padding-top: 15px;
        }

        .section-content.active {
            display: block; /* Show content when section is active */
        }
        
        .subsection-title, .template-title {
            font-weight: bold;
            color: #333;
            font-size: 1.1em;
            margin-top: 10px;
            margin-bottom: 5px;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
        }
        
        .template-title {
             display: inline;
             border-bottom: none;
             margin-right: 10px;
        }

        .term-list {
            list-style-type: none;
            padding-left: 0;
            margin: 10px 0 0 0;
            font-size: 14px;
            column-count: 3;
            column-gap: 20px;
        }
        
        .template-list li {
             list-style-type: none;
             margin-bottom: 15px;
        }

        .term-list li {
            margin-bottom: 4px;
            -webkit-column-break-inside: avoid;
            page-break-inside: avoid;
            break-inside: avoid;
        }
        
        .toggle-def-btn {
            margin-left: 5px;
            padding: 2px 6px;
            font-size: 12px;
            cursor: pointer;
        }
        .collapsible-def {
            display: none;
            white-space: pre-wrap; /* Preserve line breaks */
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-left: 3px solid #007bff;
            padding: 10px;
            margin-top: 5px;
            border-radius: 4px;
            font-family: monospace;
        }
        .collapsible-def.visible {
            display: block;
        }

        @media (max-width: 900px) { .term-list { column-count: 2; } }
        @media (max-width: 600px) { .container { flex-direction: column; } .term-list { column-count: 1; } }
    </style>
</head>
<body>
    <h1>Call Logger & Abbreviation Translator</h1>
    <div class="container">
        <div class="box">
            <h2>Enter Text Here:</h2>
            <textarea id="inputText" placeholder="Start typing... for example: cst my veh has an iss with the eng"></textarea>
        </div>
        <div class="box">
            <h2>Translated Text:</h2>
            <textarea id="translatedText" readonly></textarea>
        </div>
    </div>
    <div id="abbreviationsContainer">
        <div class="abbreviations-header">
            <h2>Available Abbreviations</h2>
            <button id="toggleAllBtn">Toggle All</button>
        </div>
        <div id="abbreviationsList"></div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const masterList = [
            {
                main_section: "Customer Statements",
                sub_sections: [ { title: "Requests & Desires", terms: { "cbb": "The Customer Requested a Repurchase...", "cce": "The customer is expecting compensation", "cdl": "The Customer Wants To Know How We Can Help With Their Delayed Repair", "cdq": "Customer wants to know if we received their sent documentation.", "cmc": "The Customer Expects More Compensation", "cre": "Customer wants to know more about a Recall...", "crr": "The Customer Would Like Warranty Rental Reimbursement", "crs": "Customer Called about their repair status.", "csa": "Customer Called About Their Existing Service Request With Their Owning Advisor", "ctw": "The Customer Would LIke Tow Reimbursement", "cud": "Customer Wants an Update", "cwr": "The Customer wants a replacement vehicle and I referred customer to the dealer." } }, { title: "State & Feelings", terms: { "ccc": "The customer stated they were concerned.", "cex": "The customer expects or is expecting", "cf": "The customer feels.", "cfc": "The customer feels that their issue should be covered", "csd": "Customer upset that their Dealer Is not diagnosing fast enough.", "cup": "Customer is Upset", "cuo": "Customer Upset that their Owning Advisor is not meeting the customer's communications expectations", "cwa": "Customer wants" } }, { title: "Allegations & Complaints", terms: { "cac": "Accusation/Accuses", "cadc": "Customer alleges GM Dealer caused further damages requiring further repairs.", "cal": "The customer alleges", "cbe": "The Customer Was Beligerent...", "cdh": "Dealer is not being honest.", "csnr": "Something not right." } }, { title: "Reports & General", terms: { "cst": "The Customer Stated", "cca": "The Customer Called Because", "cpt": "Customer states he previously requeststed Manager follow that has not happened", "crt": "Customer said Roadside towed to a GM Dealer.", "coa": "The customer advised that his Owning Advisor is not following up per his expectations or claims as promised.", "cod": "Customer mentioned issues requiring transfer to", "crb": "The Customer States They Were Referred By", "crp": "Repeat Repairs/Multiple Appointments", "dad": "Customer states vehicle is/has been down at GM Dealer for ", "dal": "The customer has a GM Dealer Allegation...", "cis": "The Customer's Issue is", "cju": "The customer attempted to justify why they feel their request should be approved.", "cok": "Customer accepted current final resolution/update/offer...", "cdc": "The customer intentionally disconnected our call.", "cnf": "Customer requested nothing further", "crf": "Customer Refused Resolution", "csc": "Customer called about Special Coverage..." } } ]
            },
            {
                main_section: "Vehicles & Parts",
                sub_sections: [ { title: "Models", terms: { "aca": "Acadia", "ax": "Trax", "bui": "Buick", "cad": "Cadillac", "cace": "Cadillac Celestiq", "cac4": "Cadillac CT4", "caee": "Cadillac Escalade ESV", "caei": "Cadillac Escalade IQL", "caly": "Cadillac Lyriq", "can": "Canyon", "cax4": "Cadillac XT4", "cax5": "Cadillac XT5", "cax6": "Cadillac XT6", "chev": "Chevrolet", "enc": "Buick Enclave", "equ": "Equinox", "esc": "Escalade", "mal": "Chevrolet Malibu", "sie": "Sierra", "silv": "Silverado", "subu": "Suburban", "ter": "Terrain", "tra": "Traverse", "yuk": "Yukon" } }, { title: "Major Components & Systems", terms: { "ac": "Air Conditioning", "dic": "Driver Information Cluster (speedometer,etc)", "elec": "Electrical System Failures", "eng": "Engine", "hvac": "Heating & Cooling", "ign": "Ignition System", "ivi": "In-Vehicle Infotainment Display (front display above console)", "rbc": "Rear Back-Up Camera/Display", "sftw": "Software", "trans": "Transmission" } }, { title: "Engine & Drivetrain Parts", terms: { "alt": "Alternator", "ams": "Camshaft Position Sensor", "bo": "Burning Oil.", "brg": "Engine Bearings (Main/Rod)", "blk": "Cylinder Block", "cam": "Camshaft", "cat": "Catalytic Converter", "coi": "Ignition Coils", "con": "Connecting Rods", "cps": "Crankshaft Position Sensor", "crk": "Crankshaft", "cyl": "Cylinder Head(s)", "def": "Diesel Def", "die": "Diesel", "dur": "Duramax", "engf": "Engine Failure Repairs", "fpm": "Fuel Pump", "fpr": "Fuel Pressure Regulator", "hdg": "Head Gaskets", "acv": "Idle Air Control (Valve)", "icm": "Ignition Control Module", "inj": "Fuel Injectors", "lft": "Lifters", "maf": "Mass Airflow Sensor", "o2s": "Oxygen (O2) Sensors", "oil": "Engine Oil and Oil Filter", "pis": "Pistons and Piston Rings", "prd": "Pushrods", "pv": "Purge Valve", "spk": "Spark Plugs", "thb": "Throttle Body", "tmb": "Timing Chain/Belt and Components", "tmc": "Timing Chain/Components", "vb": "Valve Body", "vlv": "Valve Lifter Oil Manifold with Solenoid", "wpm": "Water Pump and Cooling System Components" } }, { title: "General Parts & Issues", terms: { "ab": "Air-Bag", "afs": "Air Filter", "cel": "Check Engine Light", "clus": "Instrument Cluster Malfunctions", "flt": "Fuel Filter", "fp": "Fuel Pump Failures", "goobi": "Google Built-In", "hea": "Heating/issue", "lif": "Lifter Issues", "oc": "Oil Consumption Issues", "pac": "Part of concern-", "prof": "Display Profile", "pta": "Part is tank.", "pwst": "Power Steering Loss", "rad": "Vehicle Radio", "rka": "Rocker Arms", "rsd": "Rear Screen Display", "sta": "Stalling & Misfiring", "swc": "Ignition Switch", "veh": "vehicle" } } ]
            },
            {
                main_section: "Concepts & Coverages",
                sub_sections: [ { title: "Formal", terms: { "b2b": "Bumper To Bumper Coverage", "c/a": "GM Cost Assistance", "ccl": "Extra Component Coverage Goodwill", "cpo": "Certified Pre-Owned Vehicle", "extw": "Extended Vehicle Warranty from an Independent Provider.", "fleet": "Envolve/Fleet", "oop": "Out of Pocket Customer Pay", "pwt": "Powertrain Coverage", "rec": "recall", "reim": "Reimbursement", "sc": "Special Coverage", "vpr": "Vehicle Payment Reimbursement" } }, { title: "General", terms: { "cafa": "Catastrophic Failure", "cct": "Onstar Connections", "con": "Concern/s/ed", "iss": "issue", "ons": "Onstar" } } ]
            },
            {
                main_section: "Processes",
                sub_sections: [ { title: "Service & Repair", terms: { "appt": "Appointment", "diag": "Diagnosis.", "dr": "Delayed Repair", "pd": "The Part Delayed is", "rre": "Repeat Repairs/Appointments Failed Remedies" } }, { title: "Case Management", terms: { "bac xfer": "BAC Transfer (caller was transferred from another department)", "calesc": "The customer confirmed they live and repair is in California...", "cdep": "Customer was transferred to the applicable department.", "liveesc": "The customer requested escalation...", "reg": "Advised customer of regional escalation...", "tle": "Manager Escalation Follow-Up...", "utc1": "Unable to Contact 1st Attempt-LVM?...", "utc2": "Unable to Contact 2nd Attempt-LVM?...", "utc3": "Unable to Contact 3rd and Final Attempt-LVM?" } }, { title: "Specific Programs", terms: { "bb": "Repurchase/Buyback", "ctp": "Courtesy Transportation Program", "mrp": "General Motors My Rewards Points Program", "prd": "Post-Repair Discussion...", "reu": "Reunification Program", "rsa": "General Motors Roadside Warranty Assistance", "tre": "Tread Escalation" } } ]
            },
            {
                main_section: "Actions",
                sub_sections: [ { title: "Agent Actions", terms: { "ass": "Assisting", "f/u": "Follow-Up", "goo": "Googled and found forums alleging known issues", "ico": "Confirmed", "mtc": "Move To Close Case", "pr": "Customer will call back post-repair", "rfi": "Request For Information", "sch": "Schedule" } }, { title: "Dealer/System Actions", terms: { "acc": "Accelerate", "acco": "Accomodate/tion", "cnd": "Could Not Duplicate", "dd": "The Dealer Diagnosed", "drf": "The Dealer Referred The Customer", "dln": "Dealer did not provide a loaner", "dly": "Dealer did provide a loaner", "fai": "Failed", "pro": "Dealer Programmed", "rep": "Repair/s", "repa": "repair", "repl": "Replace/ment", "repro": "Dealer Reprogrammed", "ser": "service", "ts": "Troubleshoot/ing" } }, { title: "Templates & Checklists", terms: { "bbcl": "Mileage: \nCurrent Concerns: \nIs the vehicle currently at a GM dealership? (Yes/No) \nRepair Order Open Date: \nDiagnosis: \nIs the customer in a courtesy/rental vehicle? \nDealership & Customer Feedback: \nImportant vehicle information or feedback from the dealership: \nAssistance & Involvement: \nHas any goodwill or cost assistance been offered? (Yes/No) \nHas TAC been involved? (Yes/No) \nTAC case number and feedback: \nName of CEM at the dealer: \nSelling Information: \nDate vehicle was purchased: \nWas the customer in the military at time of purchase? (Yes/No) \nSelling dealer name and BAC: \nVehicle delivery type: \nWas the vehicle purchased new or used? \nTOTAL days vehicle has been down: \nSummary: \nBrief Repair Summary: \nAny other relevant facts for the business case:", "initcl": "Customer name: \nPhone number: \nSR number if available: \nVehicle information: \nVIN: \nYear/Make/Model: \nCurrent odometer reading: \nAny modifications (upfits, lift kits, etc.): \nNOTE: Reunites cover vehicle only, not trailers/boats. \nRepair information: \nIs this a warrantable repair under Powertrain/CPO/EV Warranty? (Y/N) \nWhat was the repair? \nNOTE: Reunites are only covered under Powertrain, CPO Powertrain, or EV Component Warranty. \nPick up information: \nDealership BAC: \nDealership name & address: \nPoint of contact name & phone number: \nDrop off information (customer home or dealership): \nFull address or Dealership info (BAC, name, address, contact): \nAdditional pertinent information:" } } ]
            },
            {
                main_section: "Documents & Identifiers",
                sub_sections: [ { title: "Case & Vehicle", terms: { "add": "Customer Mailing Address.", "cn": "Case Number:", "ct": "Call Type (IBCC/OBCC):", "dn": "Dealer Name:", "icri": "The Customer Resides In", "mile": "Vehicle Mileage:", "o": "Outcome:", "r": "Reason:", "sr": "Service Request", "sym": "Symptoms:", "vin": "Vehicle V.I.N." } }, { title: "Documents & Records", terms: { "bul": "Bulletin", "calllog": "Case Information", "cd": "Call Details", "del": "Delivery Type", "doc": "Documentation/s", "em": "Email", "esis": "ESIS Product Allegation", "eta": "Estimated Time of Arrival/Repair", "fi": "Final Invoice", "om": "Owner's Manual", "pal": "Product Allegation", "pdf": "PDF Document", "tsb": "Technical Service Bulletin" } } ]
            },
            {
                main_section: "Agent Statements & Communications",
                sub_sections: [ { title: "Advising", terms: { "iac": "I advised the Customer", "idg": "I advised to Customer that Dealer determines from diagnosis...", "idi": "I advised the customer that since GM Dealer's are independent...", "idh": "I advised the customer I will contact their dealer...", "idb": "I advised to the customer that their repurchase request was carefully reviewed and denied...", "idr": "I advised the customer that when the GM Dealer referred him to Customer Care...", "iib": "I advised the customer that in addition to the standard eligibility criteria...", "icdn": "The Customer Was Advised of Documents Needed...", "ice": "I let the customer know their request is Awaiting executive approval", "idc": "Customer was advised their complaint will be submitted...", "isc": "I advised customer about Special Coverages...", "iwr": "I advised that the New Vehicle Manufacturer Warranty...", "ica": "I have sent your allegation/s to the General Motors Dealer you complained about...", "irr": "Advised customer their request is being reviewed" } }, { title: "Actions Logged", terms: { "pde": "I confirmed customer request related to a part eligible...", "itr": "I attempted troubleshooting recommendations...", "imc": "I made contact with the customer", "ied": "I educated the customer", "idv": "I left a detailed voicemail...", "ivm": "Left Voicemail", "ipii": "I confirmed the customer Personal Identification Information...", "ipc": "I provided the customer with their case number.", "ion": "I provided the customer with their Owning Advisor's First name only.", "ipd": "I provided the customer with the denial", "ipi": "The Customer Requested Information & I Provided:", "ix": "I referred customer or customer requested being transferred to:", "ixe": "Customer was referred and transferred to EV Conceirge", "ixo": "The customer's advisor was available to transfer...", "ixr": "I offered transfer to Roadside. Customer accepted.", "aot": "The owning advisor was available in OMNI...", "cdo": "Customer was advised to send the appropriate documentation...", "eca": "Customer was educated on GM Cost Assistance policy...", "icr": "Customer was made aware of the recall...", "ide": "I de-escalated the customer who was angry" } }, { title: "Internal & General", terms: { "ina": "Internal: I was not able to find anything I could assist...", "ivia": "Vehicle is a" } } ]
            },
            {
                main_section: "Places & Departments",
                sub_sections: [ { title: "GM & Dealer", terms: { "bac": "GM Dealer/BAC", "cac": "GM Customer Assistance Center", "ccd": "Cadillac Customer Care Team", "div": "GM Divisional Office", "dlr": "GM Dealer", "dpt": "Department", "gmf": "GM FInancial", "pdt": "Part Delay Team", "tac": "Technical Assistance Center (Dealer invite only)" } }, { title: "External & Other", terms: { "ind": "Independent Dealer/Supplier/Auto Mechanic", "bbb": "Better Business Bureau verbiage" } } ]
            },
            {
                main_section: "People & Roles",
                sub_sections: [ { title: "Dealer Roles", terms: { "ds": "Dealer Sales Manager", "dsm": "Service Manager", "dlrsa": "GM Sales at Dealer", "tech": "Service Technician" } }, { title: "Corporate & Field", terms: { "cem": "Customer Experience Manager", "fse": "Field Service Engineer (Dealer Invite Only)", "rfl": "Regional Field Liason" } }, { title: "General", terms: { "cx": "Customer", "mfr": "manufacturer", "oa": "Owning Advisor" } } ]
            },
            {
                main_section: "Goodwill & Compensation Checklists",
                is_template_section: true,
                templates: [
                    { title: "Required Elements of a Business Case Checklist", text: "This checklist outlines the minimum required elements for a business case justification. Cases may be returned if the business case is insufficient.\n\nCar Payment(s)\n- Indicate whether the customer was placed in a rental or loaner.\n- Include the number of calendar days the vehicle was out of service.\n- Confirm vehicle information (VIN, YMM, mileage, warranty start date, and in/out of warranty) is documented in the SR.\n\nCBGC Protection Plan\n- Indicate why a Component Coverage Letter (CCL) cannot be offered.\n- Confirm vehicle information is documented in the SR.\n\nComponent Coverage Letter (CCL)\n- List the major repairs with the number of instances.\n\nCost Assistance\n- Include the number of new vehicles purchased by the customer based on company records.\n\nOwner Loyalty Certificate (OLC)\n- Document the MSRP.\n- The business case must state, \"The customer has purchased X new vehicles based on our records\".\n- Confirm vehicle information is documented in the SR.\n\nPre-Paid Trip Reservations\n- Include the number of new vehicles purchased by the customer.\n\nRental Reimbursement\n- If a rental was provided, the number of days the vehicle was down and the number of days the customer was in the rental are required." },
                    { title: "General Guidelines for All Compensation Offers", text: "This provides a checklist for decision-making on all compensation offers.\n\nALWAYS\n- Be a good steward of GM funds.\n- The vehicle must be repaired before the offer is made.\n- The earlier in the vehicle's lifecycle, the smaller the offer should be.\n- Start with a small offer so that additional compensation is available if needed.\n- The compensation tool should work to resolve the customer's current issue.\n- The value of the compensation should match the seriousness of the situation.\n- Guidelines for each specific compensation tool must be followed.\n\nNEVER\n- Offer compensation on Canadian vehicles (exceptions apply to OnStar, CCLs, and CBGC plans).\n- Offer car payments or rental reimbursement when the dealer has followed Courtesy Transportation Guidelines.\n- Reimburse for concerns that have not been duplicated by the dealership.\n- Offer compensation for diagnoses that are a normal characteristic of the vehicle.\n- Offer for issues already resolved by Legal Case Management (LCM).\n- To resolve sales issues.\n- As compensation for a delayed delivery.\n- For out-of-warranty wear-and-tear or maintenance items.\n- On a vehicle with a branded or salvaged title.\n- When a customer states they have retained an attorney." },
                    { title: "Cost Assistance Request Checklist", text: "This checklist guides the process when a customer requests financial help with a repair.\n\nConfirm Diagnosis: Verify the vehicle has been diagnosed by a GM dealer within the last 60 days. If not, direct the customer to a dealer without indicating that assistance will be offered.\n\nCheck for Exclusions:\n- Confirm there are no open field actions related to the concern.\n- Ensure the request is not for something that should be denied, such as standard maintenance, damage from an independent facility or natural hazard, or a vehicle with a branded title.\n\nVerify Dealer Discussion: Confirm the customer has already discussed the request with their dealer. If not, direct them to do so first.\n\nRun Policy Evaluation Tool (PET):\n- Use the actual repair estimate, not $1.\n- If the PET result is \"NOT eligible,\" cost assistance should be denied.\n- If the PET result is \"MAY BE ELIGIBLE,\" inform the customer their request will be reviewed with the dealer, but do not promise assistance or disclose the amount.\n\nPartner with the Dealer: Reach out to the dealer to see if they plan to offer assistance. The goal is to make the dealer the hero." },
                    { title: "Owner Loyalty Certificate (OLC) Decision Flow", text: "This is a step-by-step checklist to determine if an OLC should be offered and for how much.\n\n- Is the vehicle still within its bumper-to-bumper warranty?\n  If YES, do not offer an OLC.\n\n- Is the OLC being offered in combination with MyRewards or cost assistance?\n  If YES, do not offer an OLC.\n\n- Does the customer's situation fall into any other restrictions (e.g., vehicle sold in California, branded title, fleet delivery type)?\n  If YES, do not offer an OLC.\n\n- Has the customer ever purchased a new GM vehicle?\n  If NO, the OLC amount may not be more than $1,500.\n\n- Is the customer the first or second owner of the vehicle?\n  If NO (i.e., they are the third owner or later), the OLC may not be more than $2,500.\n  If YES, the OLC may be offered up to 10% of the MSRP, with amounts over $2,500 requiring pre-approval." },
                    { title: "Component Coverage Letter (CCL) Restrictions Checklist", text: "A Component Coverage Letter may not be offered in these situations:\n\n- For emissions or electrical concerns.\n- Unless all current repairs have been completed with GM parts at a GM dealership.\n- To enhance a new or used vehicle sale.\n- For 3rd+ owners, coverage cannot exceed 12 months/15,000 miles past the warranty.\n- To offset costs for a customer who falls within a special coverage or class action.\n- On vehicles with salvaged or branded titles or a warranty block.\n- For wear-and-tear components (e.g., brake pads, tires).\n- On Medium Duty vehicles or vehicles with a fleet delivery type.\n- On vehicles registered, sold, or serviced in California, New Hampshire, or Vermont." },
                    { title: "Car Payment Reimbursement Checklist", text: "This tool can be considered under the following conditions:\n\nEligibility\n- The vehicle must have an extended dealership stay of 20 or more days.\n- The stay must be for a reason outside the customer's control.\n- Repairs must have been completed under warranty at a GM dealer.\n- The offer is for in-warranty vehicles for parts delay or extended diagnosis/repair.\n\nRestrictions\n- A car payment may not be offered unless all current repairs are complete.\n- It may not be offered for the same time period as a rental reimbursement without approval.\n- It cannot be offered if a loaner vehicle was provided, without approval.\n- It is not for body shop repairs or on vehicles with branded/salvaged titles." }
                ]
            }
        ];

        const inputText = document.getElementById('inputText');
        const translatedText = document.getElementById('translatedText');
        const abbreviationsListDiv = document.getElementById('abbreviationsList');
        
        const lookupAbbreviations = fullMasterList.reduce((acc, mainSection) => {
            if (mainSection.is_template_section) return acc; // Skip template sections for lookup
            (mainSection.sub_sections || []).forEach(subSection => {
                const terms = subSection.terms || {};
                for (const term in terms) {
                    acc[term.toLowerCase()] = terms[term];
                }
            });
            return acc;
        }, {});

        function performTranslation() {
            const currentText = inputText.value;
            const parts = currentText.split(/([ \n\t.,;!?()]+)/);
            const translatedParts = parts.map(part => {
                if (!part.trim()) return part;
                const lowerPart = part.toLowerCase();
                return lookupAbbreviations.hasOwnProperty(lowerPart) ? lookupAbbreviations[lowerPart] : part;
            });
            translatedText.value = translatedParts.join('');
        }

        function populateAbbreviationsList() {
            abbreviationsListDiv.innerHTML = '';
            fullMasterList.forEach(mainSection => {
                const sectionDiv = document.createElement('div');
                sectionDiv.className = 'section';
                
                const title = document.createElement('h2');
                title.className = 'section-title';
                title.textContent = mainSection.main_section;
                
                const contentDiv = document.createElement('div');
                contentDiv.className = 'section-content';

                if (mainSection.is_template_section) {
                    const templateList = document.createElement('ul');
                    templateList.className = 'template-list';
                    mainSection.templates.forEach(template => {
                        const listItem = document.createElement('li');
                        listItem.innerHTML = `
                            <h4 class="template-title">${template.title}</h4>
                            <button class="toggle-def-btn">[Show]</button>
                            <div class="collapsible-def">${template.text}</div>`;
                        templateList.appendChild(listItem);
                    });
                    contentDiv.appendChild(templateList);
                } else {
                    (mainSection.sub_sections || []).forEach(subSection => {
                        const subTitle = document.createElement('h3');
                        subTitle.className = 'subsection-title';
                        subTitle.textContent = subSection.title;
                        contentDiv.appendChild(subTitle);
                        
                        const list = document.createElement('ul');
                        list.className = 'term-list';
                        const sortedTerms = Object.keys(subSection.terms).sort();

                        sortedTerms.forEach(term => {
                            const listItem = document.createElement('li');
                            listItem.innerHTML = `<strong>${term}</strong>: ${subSection.terms[term]}`;
                            list.appendChild(listItem);
                        });
                        contentDiv.appendChild(list);
                    });
                }

                title.addEventListener('click', () => {
                    title.classList.toggle('active');
                    contentDiv.classList.toggle('active');
                });
                
                sectionDiv.appendChild(title);
                sectionDiv.appendChild(contentDiv);
                abbreviationsListDiv.appendChild(sectionDiv);
            });
        }
        
        function setupToggleAllButton() {
            const toggleBtn = document.getElementById('toggleAllBtn');
            const allTitles = document.querySelectorAll('.section-title');
            const allContents = document.querySelectorAll('.section-content');

            if (toggleBtn) {
                toggleBtn.addEventListener('click', function() {
                    const shouldOpen = !allTitles[0].classList.contains('active');
                    allTitles.forEach(title => title.classList.toggle('active', shouldOpen));
                    allContents.forEach(content => content.classList.toggle('active', shouldOpen));
                });
            }
        }

        function setupCollapsibleDefinitions() {
            const container = document.getElementById('abbreviationsList');
            container.addEventListener('click', function(event) {
                if (event.target.classList.contains('toggle-def-btn')) {
                    const btn = event.target;
                    const definitionDiv = btn.nextElementSibling;
                    const isVisible = definitionDiv.classList.toggle('visible');
                    btn.textContent = isVisible ? '[Hide]' : '[Show]';
                }
            });
        }

        inputText.addEventListener('input', performTranslation);
        populateAbbreviationsList();
        setupToggleAllButton();
        setupCollapsibleDefinitions();
        performTranslation();
    });
    </script>
</body>
</html>
